<html>

<head>
    <link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'>

    <style>
		.show {
		    display: block;
		}
			
		.hide {
		    display: none;
		}
		.spinner-container {
			box-sizing: border-box;
		    position: relative;
		    height: 71px;
		    width: 71px;
		    margin: auto;
		}
		.spinner {
			/*Change height and width to change the size of circle*/
		    box-sizing: border-box;
		    height: 50px;
		    width: 50px;
		    position: absolute;
		    top: 50%;
		    left: 50%;
		    /*margin is half the size of spinner circle*/
		    margin: -25px 0 0 -25px;
		    -webkit-animation: rotation 1s infinite linear;
		    -moz-animation: rotation 1s infinite linear;
		    -o-animation: rotation 1s infinite linear;
		    animation: rotation 1s infinite linear;
		    border: 6px solid rgba(0, 0, 0, .2);
		    border-radius: 100%;
		    z-index: 999999;
		}
		.spinner:before {
			box-sizing: inherit;
		    content: "";
		    display: block;
		    position: absolute;
		    left: 0;
		    top: -6px;
		    height: 100%;
		    width: 100%;
		    border-top: 6px solid rgba(0, 0, 0, .8);
		    border-left: 6px solid transparent;
		    border-bottom: 6px solid transparent;
		    border-right: 6px solid transparent;
		    border-radius: 100%;
		}
		.spinner-modal-overlay {
		    /*display: none;*/ /* Hidden by default */
		    position: fixed; /* Stay in place */
		    z-index: 1; /* Sit on top */
		    padding-top: 100px; /* Location of the box */
		    left: 0;
		    top: 0;
		    width: 100%; /* Full width */
		    height: 100%; /* Full height */
		    overflow: auto; /* Enable scroll if needed */
		    background-color: rgb(0,0,0); /* Fallback color */
		    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
		}
		/* Modal Content */
		.spinner-modal-content {
		    background-color: #fefefe;
		    margin: auto;
		    padding: 10px;
		    border: 6px solid #888;
		    border-radius: 10%;
		    width: 120px;
		    text-align: center;
		}
		@-webkit-keyframes rotation {
		    from {
			-webkit-transform: rotate(0deg);
		    }
		    to {
			-webkit-transform: rotate(359deg);
		    }
		}
		@-moz-keyframes rotation {
		    from {
			-moz-transform: rotate(0deg);
		    }
		    to {
			-moz-transform: rotate(359deg);
		    }
		}
		@-o-keyframes rotation {
		    from {
			-o-transform: rotate(0deg);
		    }
		    to {
			-o-transform: rotate(359deg);
		    }
		}
		@keyframes rotation {
		    from {
			transform: rotate(0deg);
		    }
		    to {
			transform: rotate(359deg);
		    }
		}
        
        body {
            font-family: 'Open Sans';
            font-size: 14px;
        }
    </style>
    <!-- <meta http-equiv="refresh" content="0;url=https://localhost:4433/welcome"> -->
</head>

<body onload="doChecks();" style="padding:20px 40px;">
    <div id="initialSpinner" class="spinner-modal-overlay">
			<div class="spinner-modal-content" >
				<div class="spinner-container">
					<div class="spinner"></div>
				</div>
			</div>
    </div>
    <div id="no-cookies" class="hide">
            <div>
                <h2 style="color:#f36969;border-bottom:1px solid lightgray;padding-bottom:10px;">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                    	 viewBox="0 0 511.999 511.999" width="30px" 3eight="40px" style="margin-bottom: -5px;margin-right: 5px;" xml:space="preserve">
                        <g>
                        	<g>
                        		<g>
                        			<path d="M506.43,421.537L291.573,49.394c-15.814-27.391-55.327-27.401-71.147,0L5.568,421.537
                        				c-15.814,27.391,3.934,61.616,35.574,61.616h429.714C502.485,483.153,522.25,448.938,506.43,421.537z M470.856,445.51H41.142
                        				c-2.67,0-4.313-2.835-2.975-5.152L253.024,68.215c1.335-2.313,4.611-2.318,5.949,0L473.83,440.357
                        				C475.166,442.671,473.533,445.51,470.856,445.51z"/>
                        			<path d="M255.999,184.991c-10.394,0-18.821,8.427-18.821,18.821v107.89c0,10.394,8.427,18.821,18.821,18.821
                        				s18.821-8.427,18.821-18.821v-107.89C274.821,193.418,266.394,184.991,255.999,184.991z"/>
                        			<path d="M255.999,354.975c-10.394,0-18.821,8.427-18.821,18.821v11.239c0,10.394,8.427,18.821,18.821,18.821
                        				s18.821-8.427,18.821-18.821v-11.239C274.821,363.4,266.394,354.975,255.999,354.975z"/>
                        		</g>
                        	</g>
                        </g>
                    
                    </svg>Cookies Disabled! 
                </h2>Your browser seems to have cookies disabled. Cookies are required to view this site. Normally cookies can be enabled in your browser's settings. Here are some helpful articles to enable cookies in your browser.
                <ul>
                    <li><a href="" style="color:#5bc0de;">How to enable cookies in Safari</a></li>
                    <li><a href="" style="color:#5bc0de;">How to enable cookies in Safari</a></li>
                    <li><a href="" style="color:#5bc0de;">How to enable cookies in Safari</a></li>
                </ul>
            </div>
        </div>
        <script src="//cdn.jsdelivr.net/g/jquery@1.11.0"></script>
        <script src="//cdn.jsdelivr.net/jquery.cookie/1.4.0/jquery.cookie.min.js"></script>
	<script> 
	    function doChecks() {
            	var isSafari = navigator.userAgent.indexOf("Safari") > -1; // safari detection
                                
                if (!getCookieSupport()) {
                    document.getElementById("no-cookies").classList.remove('hide');
                    document.getElementById("initialSpinner").classList.add('hide');
                } else if(isSafari && !$.cookie('fixed')) {
				    forwardToCookieFix();
		        }else{
				    gotoQuote();
				}
            }
            // https://stackoverflow.com/questions/2167310/how-to-show-a-message-only-if-cookies-are-disabled-in-browser
            // Find out what cookies are supported. Returns:
            // null - no cookies
            // false - only session cookies are allowed
            // true - session cookies and persistent cookies are allowed
            // (though the persistent cookies might not actually be persistent, if the user has set
            // them to expire on browser exit)
            //
            function getCookieSupport() {
                var persist = true;
                do {
                    var c = 'gCStest=' + Math.floor(Math.random() * 100000000);
                    document.cookie = persist ? c + ';expires=Tue, 01-Jan-2030 00:00:00 GMT' : c;
                    if (document.cookie.indexOf(c) !== -1) {
                        document.cookie = c + ';expires=Sat, 01-Jan-2000 00:00:00 GMT';
                        return persist;
                    }
                } while (!(persist = !persist));
                return null;
            };
            function getUrlVars(){
              var hrefVal = window.location.href;
              var returnURL = hrefVal.replace(window.location.origin+"/", window.location.origin + "/authenticate");
              return returnURL;
            }
	    function forwardToCookieFix(){
			$.cookie('fixed', 'fixed', { expires: 365, path: '/' }); // 1 year
			
			window.location.replace("<%= communityUrl %>");
	    }
	    
          function gotoQuote() {
             window.location.assign(getUrlVars());
          }
        </script>
</body>
